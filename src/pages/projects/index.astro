---
import ProjectCard from 'src/components/ProjectCard.astro'
import { getCollection } from "astro:content";

import type { EntryFieldTypes } from 'contentful'
import IndexPageLayout from "../../layouts/IndexPageLayout.astro";

interface Project {
  contentTypeId: 'Projects'
  fields: {
    name: EntryFieldTypes.Text
    img: EntryFieldTypes.AssetLink
    website: EntryFieldTypes.EntryResourceLink<any>
    repositorio: EntryFieldTypes.EntryResourceLink<any>
  }
}

// read mdx files from projects folder as entities
const projects = await getCollection('projects');

// sort projects by dateStart DESC
projects.sort((a: any, b: any) => {
  return new Date(b.data.startDate) - new Date(a.data.startDate);
});
---

<IndexPageLayout title="Projects" description="Projects I have worked on" subTitle="My Projects">

  {
    projects.map((entity: any) => (
      <ProjectCard
        class="w-full sm:w-2/5 "
        key={entity.data.title}
        href={'/projects/' + entity.slug}
        heading={entity.data.title}
        subheading={entity.data.description}
        altText={entity?.data?.image.alt}
        imagePath={entity?.data?.image.url}
        dateStart={entity.data.startDate}
      />
    ))
  }

</IndexPageLayout>
