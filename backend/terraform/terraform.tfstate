{"version":4,"terraform_version":"1.10.5","serial":498,"lineage":"1c99a2d8-9b0d-4bad-be0d-90cfdc203c7f","outputs":{"base_url":{"value":"https://5f3ysv93x1.execute-api.us-east-1.amazonaws.com/prod","type":"string"},"function_name":{"value":"chatbot-api","type":"string"}},"resources":[{"mode":"data","type":"archive_file","name":"lambda_chatbot","provider":"provider[\"registry.opentofu.org/hashicorp/archive\"]","instances":[{"schema_version":0,"attributes":{"exclude_symlink_directories":null,"excludes":null,"id":"1e486f0997c59319da6259298535d0cb15d642e1","output_base64sha256":"jsGnnQKOnslqUV981BFyV0jF3FjwPOiMs3PPCHaBmy4=","output_base64sha512":"6G55O1mDuwhgQK7tpFVnItdh71ej5WvGN8kCMgCyugo3TXNr6ZBqg+NldJDShf50cfo36yLsT2UUfnK/041ZSQ==","output_file_mode":null,"output_md5":"0296798354d863a0323fa06f7a573b62","output_path":"./../chatbot-function.zip","output_sha":"1e486f0997c59319da6259298535d0cb15d642e1","output_sha256":"8ec1a79d028e9ec96a515f7cd411725748c5dc58f03ce88cb373cf0876819b2e","output_sha512":"e86e793b5983bb086040aeeda4556722d761ef57a3e56bc637c9023200b2ba0a374d736be9906a83e3657490d285fe7471fa37eb22ec4f65147e72bfd38d5949","output_size":662187,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"./../chatbot","source_file":null,"type":"zip"},"sensitive_attributes":[]}]},{"mode":"data","type":"aws_ssm_parameter","name":"openai_api_key","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:ssm:us-east-1:149536489028:parameter/myapp/OPENAI_API_KEY","id":"/myapp/OPENAI_API_KEY","insecure_value":"","name":"/myapp/OPENAI_API_KEY","type":"SecureString","value":"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","version":2,"with_decryption":true},"sensitive_attributes":[]}]},{"mode":"managed","type":"aws_api_gateway_deployment","name":"chatbot_deployment","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"created_date":"2025-09-01T23:47:29Z","description":"","execution_arn":"arn:aws:execute-api:us-east-1:149536489028:5f3ysv93x1/","id":"hr58zc","invoke_url":"https://5f3ysv93x1.execute-api.us-east-1.amazonaws.com/","rest_api_id":"5f3ysv93x1","stage_description":null,"stage_name":null,"triggers":{"redeployment":"3fd6520ff797adbeef56b4d045fbda2f4a995221"},"variables":null},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_integration.lambda_integration","aws_api_gateway_integration.options_integration","aws_api_gateway_integration_response.lambda_integration_response","aws_api_gateway_integration_response.options_integration_response","aws_api_gateway_method.options_method","aws_api_gateway_method.post_method","aws_api_gateway_method_response.options_method_response","aws_api_gateway_method_response.post_method_response","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api","aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration","name":"lambda_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"cache_key_parameters":[],"cache_namespace":"keytrf","connection_id":"","connection_type":"INTERNET","content_handling":"","credentials":"","http_method":"POST","id":"agi-5f3ysv93x1-keytrf-POST","integration_http_method":"POST","passthrough_behavior":"WHEN_NO_MATCH","request_parameters":{},"request_templates":{},"resource_id":"keytrf","rest_api_id":"5f3ysv93x1","timeout_milliseconds":29000,"tls_config":[],"type":"AWS_PROXY","uri":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:149536489028:function:chatbot-api/invocations"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.post_method","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api","aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration","name":"options_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"cache_key_parameters":[],"cache_namespace":"keytrf","connection_id":"","connection_type":"INTERNET","content_handling":"","credentials":"","http_method":"OPTIONS","id":"agi-5f3ysv93x1-keytrf-OPTIONS","integration_http_method":"","passthrough_behavior":"WHEN_NO_MATCH","request_parameters":{},"request_templates":{"application/json":"{\"statusCode\": 200}"},"resource_id":"keytrf","rest_api_id":"5f3ysv93x1","timeout_milliseconds":29000,"tls_config":[],"type":"MOCK","uri":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.options_method","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration_response","name":"lambda_integration_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"content_handling":"","http_method":"POST","id":"agir-5f3ysv93x1-keytrf-POST-200","resource_id":"keytrf","response_parameters":{},"response_templates":{},"rest_api_id":"5f3ysv93x1","selection_pattern":"","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_integration.lambda_integration","aws_api_gateway_method.post_method","aws_api_gateway_method_response.post_method_response","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api","aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration_response","name":"options_integration_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"content_handling":"","http_method":"OPTIONS","id":"agir-5f3ysv93x1-keytrf-OPTIONS-200","resource_id":"keytrf","response_parameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Methods":"'GET,OPTIONS,POST'","method.response.header.Access-Control-Allow-Origin":"'*'"},"response_templates":{},"rest_api_id":"5f3ysv93x1","selection_pattern":"","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_integration.options_integration","aws_api_gateway_method.options_method","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method","name":"options_method","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_required":false,"authorization":"NONE","authorization_scopes":[],"authorizer_id":"","http_method":"OPTIONS","id":"agm-5f3ysv93x1-keytrf-OPTIONS","operation_name":"","request_models":{},"request_parameters":{},"request_validator_id":"","resource_id":"keytrf","rest_api_id":"5f3ysv93x1"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method","name":"post_method","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_required":false,"authorization":"NONE","authorization_scopes":[],"authorizer_id":"","http_method":"POST","id":"agm-5f3ysv93x1-keytrf-POST","operation_name":"","request_models":{},"request_parameters":{},"request_validator_id":"","resource_id":"keytrf","rest_api_id":"5f3ysv93x1"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method_response","name":"options_method_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"http_method":"OPTIONS","id":"agmr-5f3ysv93x1-keytrf-OPTIONS-200","resource_id":"keytrf","response_models":{},"response_parameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Origin":true},"rest_api_id":"5f3ysv93x1","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.options_method","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method_response","name":"post_method_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"http_method":"POST","id":"agmr-5f3ysv93x1-keytrf-POST-200","resource_id":"keytrf","response_models":{},"response_parameters":{"method.response.header.Access-Control-Allow-Origin":true},"rest_api_id":"5f3ysv93x1","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.post_method","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_resource","name":"ask_resource","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"keytrf","parent_id":"hmoefs37m0","path":"/ask","path_part":"ask","rest_api_id":"5f3ysv93x1"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_rest_api.chatbot_rest_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_rest_api","name":"chatbot_rest_api","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_source":"HEADER","arn":"arn:aws:apigateway:us-east-1::/restapis/5f3ysv93x1","binary_media_types":[],"body":null,"created_date":"2025-09-01T22:53:19Z","description":"REST API for Chatbot Lambda function","disable_execute_api_endpoint":false,"endpoint_configuration":[{"types":["EDGE"],"vpc_endpoint_ids":[]}],"execution_arn":"arn:aws:execute-api:us-east-1:149536489028:5f3ysv93x1","fail_on_warnings":null,"id":"5f3ysv93x1","minimum_compression_size":"","name":"chatbot-rest-api","parameters":null,"policy":"","put_rest_api_mode":null,"root_resource_id":"hmoefs37m0","tags":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner"},"tags_all":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner","hashicorp-learn":"lambda-api-gateway"}},"sensitive_attributes":[],"private":"bnVsbA==","create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_stage","name":"prod_stage","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"access_log_settings":[],"arn":"arn:aws:apigateway:us-east-1::/restapis/5f3ysv93x1/stages/prod","cache_cluster_enabled":false,"cache_cluster_size":"","canary_settings":[],"client_certificate_id":"","deployment_id":"hr58zc","description":"","documentation_version":"","execution_arn":"arn:aws:execute-api:us-east-1:149536489028:5f3ysv93x1/prod","id":"ags-5f3ysv93x1-prod","invoke_url":"https://5f3ysv93x1.execute-api.us-east-1.amazonaws.com/prod","rest_api_id":"5f3ysv93x1","stage_name":"prod","tags":{},"tags_all":{"hashicorp-learn":"lambda-api-gateway"},"variables":{},"web_acl_arn":"","xray_tracing_enabled":false},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_deployment.chatbot_deployment","aws_api_gateway_integration.lambda_integration","aws_api_gateway_integration.options_integration","aws_api_gateway_integration_response.lambda_integration_response","aws_api_gateway_integration_response.options_integration_response","aws_api_gateway_method.options_method","aws_api_gateway_method.post_method","aws_api_gateway_method_response.options_method_response","aws_api_gateway_method_response.post_method_response","aws_api_gateway_resource.ask_resource","aws_api_gateway_rest_api.chatbot_rest_api","aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"]}]},{"mode":"managed","type":"aws_cloudwatch_log_group","name":"lambda_chatbot","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:logs:us-east-1:149536489028:log-group:/aws/lambda/chatbot-api","id":"/aws/lambda/chatbot-api","kms_key_id":"","log_group_class":"STANDARD","name":"/aws/lambda/chatbot-api","name_prefix":"","retention_in_days":30,"skip_destroy":false,"tags":{},"tags_all":{"hashicorp-learn":"lambda-api-gateway"}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"]}]},{"mode":"managed","type":"aws_cloudwatch_log_group","name":"rest_api_logs","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:logs:us-east-1:149536489028:log-group:/aws/apigateway/chatbot-rest-api","id":"/aws/apigateway/chatbot-rest-api","kms_key_id":"","log_group_class":"STANDARD","name":"/aws/apigateway/chatbot-rest-api","name_prefix":"","retention_in_days":30,"skip_destroy":false,"tags":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner"},"tags_all":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner","hashicorp-learn":"lambda-api-gateway"}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_rest_api.chatbot_rest_api"]}]},{"mode":"managed","type":"aws_iam_role","name":"lambda_chatbot_role","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::149536489028:role/serverless_lambda","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Sid\":\"\"}],\"Version\":\"2012-10-17\"}","create_date":"2025-09-01T22:53:19Z","description":"","force_detach_policies":false,"id":"serverless_lambda","inline_policy":[{"name":"lambda_ssm_access","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"ssm:GetParameter\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:ssm:us-east-1:149536489028:parameter/myapp/OPENAI_API_KEY\"}]}"}],"managed_policy_arns":["arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"],"max_session_duration":3600,"name":"serverless_lambda","name_prefix":"","path":"/","permissions_boundary":"","tags":{},"tags_all":{"hashicorp-learn":"lambda-api-gateway"},"unique_id":"AROASFUIRXZCAKECHVFDQ"},"sensitive_attributes":[],"private":"bnVsbA==","create_before_destroy":true}]},{"mode":"managed","type":"aws_iam_role_policy","name":"lambda_ssm_policy","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"serverless_lambda:lambda_ssm_access","name":"lambda_ssm_access","name_prefix":"","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"ssm:GetParameter\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:ssm:us-east-1:149536489028:parameter/myapp/OPENAI_API_KEY\"}]}","role":"serverless_lambda"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.lambda_chatbot_role","data.aws_ssm_parameter.openai_api_key"]}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_policy","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"serverless_lambda-20250901225319877600000001","policy_arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","role":"serverless_lambda"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.lambda_chatbot_role"]}]},{"mode":"managed","type":"aws_lambda_function","name":"chatbot_lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"architectures":["arm64"],"arn":"arn:aws:lambda:us-east-1:149536489028:function:chatbot-api","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"OPENAI_API_KEY":"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"}}],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":null,"function_name":"chatbot-api","handler":"","id":"chatbot-api","image_config":[],"image_uri":"149536489028.dkr.ecr.us-east-1.amazonaws.com/chatbot-lambda:latest","invoke_arn":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:149536489028:function:chatbot-api/invocations","kms_key_arn":"","last_modified":"2025-09-02T18:23:52.000+0000","layers":[],"logging_config":[{"application_log_level":"","log_format":"Text","log_group":"/aws/lambda/chatbot-api","system_log_level":""}],"memory_size":512,"package_type":"Image","publish":false,"qualified_arn":"arn:aws:lambda:us-east-1:149536489028:function:chatbot-api:$LATEST","qualified_invoke_arn":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:149536489028:function:chatbot-api:$LATEST/invocations","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::149536489028:role/serverless_lambda","runtime":"","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","skip_destroy":false,"snap_start":[],"source_code_hash":"f2bdcf266e6b4a02fae62056b6db67ba89d5c063a3c959c96675f4a1c00e1eb6","source_code_size":0,"tags":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner"},"tags_all":{"Application":"Chatbot","Environment":"Production","Owner":"TCHeiner","hashicorp-learn":"lambda-api-gateway"},"timeout":900,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[]},"sensitive_attributes":[[{"type":"get_attr","value":"environment"},{"type":"index","value":{"value":0,"type":"number"}},{"type":"get_attr","value":"variables"},{"type":"index","value":{"value":"OPENAI_API_KEY","type":"string"}}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19","dependencies":["aws_iam_role.lambda_chatbot_role","data.aws_ssm_parameter.openai_api_key"]}]},{"mode":"managed","type":"aws_lambda_permission","name":"chatbot_api_gw","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"chatbot-api","function_url_auth_type":null,"id":"AllowExecutionFromAPIGateway","principal":"apigateway.amazonaws.com","principal_org_id":null,"qualifier":"","source_account":null,"source_arn":"arn:aws:execute-api:us-east-1:149536489028:5f3ysv93x1/*/*","statement_id":"AllowExecutionFromAPIGateway","statement_id_prefix":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_rest_api.chatbot_rest_api","aws_iam_role.lambda_chatbot_role","aws_lambda_function.chatbot_lambda","data.aws_ssm_parameter.openai_api_key"]}]}],"check_results":null}
